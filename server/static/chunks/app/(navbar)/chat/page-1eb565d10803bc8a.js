(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[545],{2097:function(e,t,o){Promise.resolve().then(o.bind(o,2069))},2069:function(e,t,o){"use strict";o.r(t);var n=o(7437),s=o(2265);o(9285),t.default=()=>{let[e,t]=(0,s.useState)(""),[o,c]=(0,s.useState)(""),[a,l]=(0,s.useState)(),[r,i]=(0,s.useState)(),[u,h]=(0,s.useState)(null);async function f(){let e=await fetch("/api/getChat",{method:"GET"});200==e.status&&i(await e.json())}async function d(){let e=await fetch("/api/authenticate",{method:"GET"});200==e.status&&c((await e.json()).username)}return(0,s.useEffect)(()=>{a&&(a.onopen=()=>{console.log("WebSocket connected")},a.onmessage=e=>{console.log("Message received:",e.data),f()},a.onerror=e=>{console.error("WebSocket error:",e)},a.onclose=()=>{console.log("WebSocket closed")},window.removeEventListener("beforeunload",()=>{a.close()}))}),(0,s.useEffect)(()=>{u&&(u.scrollTop=u.scrollHeight),console.log(r)},[r,u]),(0,s.useEffect)(()=>{var e=document.querySelector(".chatbox");d(),console.log("ws://"+window.location.host+"/web-socket/chat"),l(new WebSocket("ws://"+window.location.host+"/web-socket/chat")),f(),e&&e.scrollIntoView()},[]),""!==o&&(0,n.jsx)("div",{className:"homepage",children:(0,n.jsxs)("div",{className:"home-section",children:[(0,n.jsx)("div",{className:"chatbox",ref:e=>h(e),children:function(){let e=[];if(r)for(let t of r){let o=t.username+": "+t.content;e.push((0,n.jsx)("p",{children:o},t.id))}return e}()}),(0,n.jsx)("input",{className:"chat-input",type:"text",value:e,onChange:e=>{t(e.target.value)},onKeyDown:n=>{"Enter"===n.key&&(a&&0!=e.length&&a.send(JSON.stringify({type:"postChat",username:o,message:e})),t(""))},placeholder:"Enter message"})]})})}},9285:function(){}},function(e){e.O(0,[416,971,69,744],function(){return e(e.s=2097)}),_N_E=e.O()}]);